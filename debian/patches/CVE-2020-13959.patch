Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=985221
Comments: Adapted for velocity-tools 2.0 and commons-lang 2.6 from:
 https://github.com/apache/velocity-tools/commit/e141828a4eb03e4b0224535eed12b5c463a24152.patch

From e141828a4eb03e4b0224535eed12b5c463a24152 Mon Sep 17 00:00:00 2001
From: Jackson Henry <54763344+JHHAX@users.noreply.github.com>
Date: Thu, 8 Oct 2020 14:18:25 +1100
Subject: [PATCH] Fixed Reflected XSS Vuln

Velocity Tools has an automatically generated error page, which echoes back the file name unescaped. This commit sanitizes user input and fixes the XSS Vulnerability!

Updated XSS Vuln fix (used StringEscapeUtils)
---
 .../org/apache/velocity/tools/view/VelocityViewServlet.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/src/main/java/org/apache/velocity/tools/view/VelocityViewServlet.java
+++ b/src/main/java/org/apache/velocity/tools/view/VelocityViewServlet.java
@@ -351,7 +351,7 @@
             html.append("<head><title>Error</title></head>\n");
             html.append("<body>\n");
             html.append("<h2>VelocityView : Error processing a template for path '");
-            html.append(path);
+            html.append(StringEscapeUtils.escapeHtml(path));
             html.append("'</h2>\n");
 
             Throwable cause = e;
